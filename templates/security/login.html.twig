{% extends 'base.html.twig' %}

{% block title %}Login | Lamma Event{% endblock %}

{% block body %}
<div class="container d-flex flex-column align-items-center justify-content-center min-vh-100">

    <!-- 🔵 Titre principal -->
    <div class="text-center mb-4">
        <h1 class="display-5 fw-bold text-primary">LAMMA EVENT</h1>
        <p class="text-muted small">Manage your events easily and quickly</p>
    </div>

    <!-- 🟣 Formulaire de connexion -->
    <div class="card p-5 shadow rounded-4 w-100" style="max-width: 420px;">
        <form method="post" class="dark-mode-form">

            <!-- 🔴 Messages d'alerte -->
            {% if error %}
                <div class="alert alert-danger small text-center mb-4">
                    {{ error.messageKey|trans(error.messageData, 'security') }}
                </div>
            {% endif %}

            {% if app.user %}
                <div class="alert alert-success text-center mb-4">
                    Logged in as <strong>{{ app.user.userIdentifier }}</strong>.
                    <a href="{{ path('app_logout') }}" class="btn btn-outline-danger btn-sm ms-2">Logout</a>
                </div>
            {% endif %}

            <!-- 🟠 Titre du formulaire -->
            <h2 class="h5 text-center mb-4 fw-semibold">Welcome Back 👋</h2>

            <!-- 🟡 Email input -->
            <div class="form-floating mb-3">
                <input type="email" id="inputEmail" name="email" value="{{ last_username }}" class="form-control" placeholder="Email" autocomplete="email" required autofocus>
                <label for="inputEmail">Email Address</label>
            </div>

            <!-- 🟢 Password input + toggle button -->
            <div class="form-floating mb-3 position-relative">
                <input type="password" id="inputPassword" name="password" class="form-control" placeholder="Password" autocomplete="current-password" required>
                <label for="inputPassword">Password</label>
                <button type="button" id="togglePassword" class="btn position-absolute end-0 top-50 translate-middle-y me-3 p-0 border-0" style="width: 35px; height: 35px; background: none;">
                    👁️
                </button>
            </div>

            <!-- 🟤 CSRF token -->
            <input type="hidden" name="_csrf_token" value="{{ csrf_token('authenticate') }}">

            <!-- 🟣 Remember Me -->
            <div class="form-check mb-4">
                <input class="form-check-input" type="checkbox" id="rememberMe" name="_remember_me">
                <label class="form-check-label small" for="rememberMe">Remember me</label>
            </div>

            <!-- 🟠 Bouton de connexion -->
            <button type="submit" class="btn btn-primary w-100 mb-3 fw-bold">
                🔒 Sign In
            </button>

            <!-- 🔵 Liens secondaires -->
            <div class="text-center mb-2">
                <a href="{{ path('app_forgot_password') }}" class="small text-decoration-none text-primary">Forgot Password?</a>
            </div>

            <div class="text-center small">
                Don't have an account? 
                <a href="{{ path('app_register') }}" class="fw-bold text-decoration-none text-primary">Sign Up</a>
            </div>

        </form>
    </div>
</div>

<!-- 🎨 CSS interne -->
<style>
/* 🎨 Dark Mode */
body.dark-mode .dark-mode-form {
    background-color: #2d2d3f;
    color: #e0e0e0;
}
body.dark-mode .dark-mode-form input,
body.dark-mode .dark-mode-form label {
    background-color: #393953;
    color: #e0e0e0;
    border: 1px solid #555;
}
body.dark-mode .dark-mode-form .form-control::placeholder {
    color: #bbb;
}

/* 🎨 Bouton Affichage mot de passe */
#togglePassword {
    font-size: 1.3rem;
    cursor: pointer;
    transition: transform 0.2s ease, color 0.2s ease;
}
#togglePassword:hover {
    color: #f35525;
    transform: scale(1.2);
}
</style>

<!-- 🚀 JavaScript interne -->
<script>
document.addEventListener('DOMContentLoaded', () => {
    const togglePassword = document.getElementById('togglePassword');
    const passwordInput = document.getElementById('inputPassword');

    togglePassword.addEventListener('click', () => {
        const isPassword = passwordInput.getAttribute('type') === 'password';
        passwordInput.setAttribute('type', isPassword ? 'text' : 'password');
        togglePassword.textContent = isPassword ? '🙈' : '👁️';
    });
});
</script>
{% endblock %}
