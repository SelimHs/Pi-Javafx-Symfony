<div class="container mt-5">
    {{ form_start(form, {'attr': {'novalidate': 'novalidate'}}) }}

    <div class="p-4 shadow rounded bg-light">

        {% if form_errors(form) %}
            <div class="alert alert-danger">
                <strong>‚ö†Ô∏è Veuillez corriger les erreurs suivantes :</strong>
                {{ form_errors(form) }}
            </div>
        {% endif %}

        <div class="mb-3">
            <label class="form-label fw-bold">üìÜ Date de R√©servation</label>
            {{ form_widget(form.dateReservation) }}
            {% if form_errors(form.dateReservation) %}
                <div class="text-danger small">{{ form_errors(form.dateReservation) }}</div>
            {% else %}
                <div class="text-muted small">S√©lectionnez une date (format : YYYY-MM-DD).</div>
                {% if form.dateReservation.vars.data is not null %}
                    <div class="text-info small">
                        Date s√©lectionn√©e : {{ form.dateReservation.vars.data|date('Y-m-d H:i') }}
                    </div>
                {% endif %}
            {% endif %}
        </div>






        <!-- ‚úÖ Utilisateur -->
        <div class="mb-3">
            <label class="form-label fw-bold">üë§ Utilisateur</label>
            {{ form_widget(form.user, {'attr': {'class': 'form-select'}}) }}
            {% if form_errors(form.user) %}
                <div class="text-danger small">{{ form_errors(form.user) }}</div>
            {% else %}
                <div class="text-muted small">S√©lectionnez un utilisateur existant.</div>
            {% endif %}
        </div>



        <!-- ‚úÖ Boutons -->
        <div class="text-end mt-4">
            <button type="submit" class="btn btn-success">
                ‚úÖ {{ button_label|default('Enregistrer la R√©servation') }}
            </button>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const form = document.querySelector('form');
            const dateInput = document.querySelector('input[name$="[dateReservation]"]');

            form.addEventListener('submit', function (event) {
                const errorDiv = document.getElementById('date-error');

                // clear old error
                if (errorDiv) {
                    errorDiv.remove();
                }

                if (!dateInput.value) {
                    event.preventDefault();

                    // inject error message just after the date input
                    const errorMessage = document.createElement('div');
                    errorMessage.className = 'text-danger small mt-1';
                    errorMessage.id = 'date-error';
                    errorMessage.innerText = "‚ö†Ô∏è Veuillez s√©lectionner une date de r√©servation.";
                    dateInput.parentNode.appendChild(errorMessage);

                    // style the field in red
                    dateInput.classList.add('is-invalid');
                } else {
                    dateInput.classList.remove('is-invalid');
                }
            });
        });
    </script>
    {{ form_end(form) }}
</div>